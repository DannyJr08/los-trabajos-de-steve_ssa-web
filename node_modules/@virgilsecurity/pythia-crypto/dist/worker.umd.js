!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).VirgilPythiaCrypto={})}(this,(function(t){"use strict";var e=function(t,e){return function(t,e){var r,n=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(t){var e;t=t||{},e||(e=void 0!==t?t:{});var n,a={};for(n in e)e.hasOwnProperty(n)&&(a[n]=e[n]);function o(t,e){throw e}var i="";document.currentScript&&(i=document.currentScript.src),r&&(i=r),i=0!==i.indexOf("blob:")?i.substr(0,i.lastIndexOf("/")+1):"";var s=e.print||console.log.bind(console),f=e.printErr||console.warn.bind(console);for(n in a)a.hasOwnProperty(n)&&(e[n]=a[n]);a=null,e.quit&&(o=e.quit);var u,c,l=0;e.wasmBinary&&(u=e.wasmBinary),e.noExitRuntime&&(c=e.noExitRuntime),"object"!=typeof WebAssembly&&f("no native wasm support detected");var h,_,p,d,y,v,w=new WebAssembly.Table({initial:321,maximum:321,element:"anyfunc"}),m=!1,b="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function g(t,e,r){var n=e+r;for(r=e;t[r]&&!(r>=n);)++r;if(16<r-e&&t.subarray&&b)return b.decode(t.subarray(e,r));for(n="";e<r;){var a=t[e++];if(128&a){var o=63&t[e++];if(192==(224&a))n+=String.fromCharCode((31&a)<<6|o);else{var i=63&t[e++];65536>(a=224==(240&a)?(15&a)<<12|o<<6|i:(7&a)<<18|o<<12|i<<6|63&t[e++])?n+=String.fromCharCode(a):(a-=65536,n+=String.fromCharCode(55296|a>>10,56320|1023&a))}}else n+=String.fromCharCode(a)}return n}function E(t){_=t,e.HEAP8=p=new Int8Array(t),e.HEAP16=y=new Int16Array(t),e.HEAP32=v=new Int32Array(t),e.HEAPU8=d=new Uint8Array(t),e.HEAPU16=new Uint16Array(t),e.HEAPU32=new Uint32Array(t),e.HEAPF32=new Float32Array(t),e.HEAPF64=new Float64Array(t)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var P=e.INITIAL_MEMORY||16777216;function A(t){for(;0<t.length;){var r=t.shift();if("function"==typeof r)r();else{var n=r.ub;"number"==typeof n?void 0===r.bb?e.dynCall_v(n):e.dynCall_vi(n,r.bb):n(void 0===r.bb?null:r.bb)}}}(h=e.wasmMemory?e.wasmMemory:new WebAssembly.Memory({initial:P/65536}))&&(_=h.buffer),P=_.byteLength,E(_),v[16576]=5309344;var T=[],x=[],B=[],M=[];function S(){var t=e.preRun.shift();T.unshift(t)}var I=Math.abs,L=Math.ceil,k=Math.floor,C=Math.min,R=0,U=null;function O(t){throw e.onAbort&&e.onAbort(t),s(t),f(t),m=!0,new WebAssembly.RuntimeError("abort("+t+"). Build with -s ASSERTIONS=1 for more info.")}function K(){var t=j;return String.prototype.startsWith?t.startsWith("data:application/octet-stream;base64,"):0===t.indexOf("data:application/octet-stream;base64,")}e.preloadedImages={},e.preloadedAudios={};var N,z,j="libpythia.browser.wasm";if(!K()){var H=j;j=e.locateFile?e.locateFile(H,i):i+H}function Y(){try{if(u)return new Uint8Array(u);throw"both async and sync fetching of the wasm failed"}catch(t){O(t)}}function J(t,e){for(var r=0,n=t.length-1;0<=n;n--){var a=t[n];"."===a?t.splice(n,1):".."===a?(t.splice(n,1),r++):r&&(t.splice(n,1),r--)}if(e)for(;r;r--)t.unshift("..");return t}function D(t){var e="/"===t.charAt(0),r="/"===t.substr(-1);return(t=J(t.split("/").filter((function(t){return!!t})),!e).join("/"))||e||(t="."),t&&r&&(t+="/"),(e?"/":"")+t}function F(t){var e=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/.exec(t).slice(1);return t=e[0],e=e[1],t||e?(e&&(e=e.substr(0,e.length-1)),t+e):"."}function V(t){if("/"===t)return"/";var e=t.lastIndexOf("/");return-1===e?t:t.substr(e+1)}function W(){for(var t="",e=!1,r=arguments.length-1;-1<=r&&!e;r--){if("string"!=typeof(e=0<=r?arguments[r]:"/"))throw new TypeError("Arguments to path.resolve must be strings");if(!e)return"";t=e+"/"+t,e="/"===e.charAt(0)}return(e?"/":"")+(t=J(t.split("/").filter((function(t){return!!t})),!e).join("/"))||"."}x.push({ub:function(){Jt()}});var Q=[];function q(t,e){Q[t]={input:[],Na:[],Va:e},bt(t,X)}var X={open:function(t){var e=Q[t.node.$a];if(!e)throw new st(43);t.Ma=e,t.seekable=!1},close:function(t){t.Ma.Va.flush(t.Ma)},flush:function(t){t.Ma.Va.flush(t.Ma)},read:function(t,e,r,n){if(!t.Ma||!t.Ma.Va.lb)throw new st(60);for(var a=0,o=0;o<n;o++){try{var i=t.Ma.Va.lb(t.Ma)}catch(t){throw new st(29)}if(void 0===i&&0===a)throw new st(6);if(null==i)break;a++,e[r+o]=i}return a&&(t.node.timestamp=Date.now()),a},write:function(t,e,r,n){if(!t.Ma||!t.Ma.Va.eb)throw new st(60);try{for(var a=0;a<n;a++)t.Ma.Va.eb(t.Ma,e[r+a])}catch(t){throw new st(29)}return n&&(t.node.timestamp=Date.now()),a}},$={lb:function(t){if(!t.input.length){var e=null;if("undefined"!=typeof window&&"function"==typeof window.prompt?null!==(e=window.prompt("Input: "))&&(e+="\n"):"function"==typeof readline&&null!==(e=readline())&&(e+="\n"),!e)return null;for(var r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);55296<=a&&57343>=a&&(a=65536+((1023&a)<<10)|1023&e.charCodeAt(++n)),127>=a?++r:r=2047>=a?r+2:65535>=a?r+3:r+4}var o=(r=Array(r+1)).length;if(n=0,0<o){a=n,o=n+o-1;for(var i=0;i<e.length;++i){var s=e.charCodeAt(i);if(55296<=s&&57343>=s&&(s=65536+((1023&s)<<10)|1023&e.charCodeAt(++i)),127>=s){if(n>=o)break;r[n++]=s}else{if(2047>=s){if(n+1>=o)break;r[n++]=192|s>>6}else{if(65535>=s){if(n+2>=o)break;r[n++]=224|s>>12}else{if(n+3>=o)break;r[n++]=240|s>>18,r[n++]=128|s>>12&63}r[n++]=128|s>>6&63}r[n++]=128|63&s}}r[n]=0,e=n-a}else e=0;r.length=e,t.input=r}return t.input.shift()},eb:function(t,e){null===e||10===e?(s(g(t.Na,0)),t.Na=[]):0!=e&&t.Na.push(e)},flush:function(t){t.Na&&0<t.Na.length&&(s(g(t.Na,0)),t.Na=[])}},Z={eb:function(t,e){null===e||10===e?(f(g(t.Na,0)),t.Na=[]):0!=e&&t.Na.push(e)},flush:function(t){t.Na&&0<t.Na.length&&(f(g(t.Na,0)),t.Na=[])}},G={Oa:null,Qa:function(){return G.createNode(null,"/",16895,0)},createNode:function(t,e,r,n){if(24576==(61440&r)||4096==(61440&r))throw new st(63);return G.Oa||(G.Oa={dir:{node:{Ta:G.Ja.Ta,Pa:G.Ja.Pa,Wa:G.Ja.Wa,Ya:G.Ja.Ya,qb:G.Ja.qb,sb:G.Ja.sb,rb:G.Ja.rb,pb:G.Ja.pb,ab:G.Ja.ab},stream:{Ua:G.Ka.Ua}},file:{node:{Ta:G.Ja.Ta,Pa:G.Ja.Pa},stream:{Ua:G.Ka.Ua,read:G.Ka.read,write:G.Ka.write,gb:G.Ka.gb,mb:G.Ka.mb,ob:G.Ka.ob}},link:{node:{Ta:G.Ja.Ta,Pa:G.Ja.Pa,Xa:G.Ja.Xa},stream:{}},hb:{node:{Ta:G.Ja.Ta,Pa:G.Ja.Pa},stream:mt}}),16384==(61440&(r=_t(t,e,r,n)).mode)?(r.Ja=G.Oa.dir.node,r.Ka=G.Oa.dir.stream,r.Ia={}):32768==(61440&r.mode)?(r.Ja=G.Oa.file.node,r.Ka=G.Oa.file.stream,r.La=0,r.Ia=null):40960==(61440&r.mode)?(r.Ja=G.Oa.link.node,r.Ka=G.Oa.link.stream):8192==(61440&r.mode)&&(r.Ja=G.Oa.hb.node,r.Ka=G.Oa.hb.stream),r.timestamp=Date.now(),t&&(t.Ia[e]=r),r},Gb:function(t){if(t.Ia&&t.Ia.subarray){for(var e=[],r=0;r<t.La;++r)e.push(t.Ia[r]);return e}return t.Ia},Hb:function(t){return t.Ia?t.Ia.subarray?t.Ia.subarray(0,t.La):new Uint8Array(t.Ia):new Uint8Array(0)},ib:function(t,e){var r=t.Ia?t.Ia.length:0;r>=e||(e=Math.max(e,r*(1048576>r?2:1.125)|0),0!=r&&(e=Math.max(e,256)),r=t.Ia,t.Ia=new Uint8Array(e),0<t.La&&t.Ia.set(r.subarray(0,t.La),0))},yb:function(t,e){if(t.La!=e)if(0==e)t.Ia=null,t.La=0;else{if(!t.Ia||t.Ia.subarray){var r=t.Ia;t.Ia=new Uint8Array(e),r&&t.Ia.set(r.subarray(0,Math.min(e,t.La)))}else if(t.Ia||(t.Ia=[]),t.Ia.length>e)t.Ia.length=e;else for(;t.Ia.length<e;)t.Ia.push(0);t.La=e}},Ja:{Ta:function(t){var e={};return e.Fb=8192==(61440&t.mode)?t.id:1,e.Jb=t.id,e.mode=t.mode,e.Lb=1,e.uid=0,e.Ib=0,e.$a=t.$a,16384==(61440&t.mode)?e.size=4096:32768==(61440&t.mode)?e.size=t.La:40960==(61440&t.mode)?e.size=t.link.length:e.size=0,e.Cb=new Date(t.timestamp),e.Kb=new Date(t.timestamp),e.Eb=new Date(t.timestamp),e.tb=4096,e.Db=Math.ceil(e.size/e.tb),e},Pa:function(t,e){void 0!==e.mode&&(t.mode=e.mode),void 0!==e.timestamp&&(t.timestamp=e.timestamp),void 0!==e.size&&G.yb(t,e.size)},Wa:function(){throw ft[44]},Ya:function(t,e,r,n){return G.createNode(t,e,r,n)},qb:function(t,e,r){if(16384==(61440&t.mode)){try{var n=ht(e,r)}catch(t){}if(n)for(var a in n.Ia)throw new st(55)}delete t.parent.Ia[t.name],t.name=r,e.Ia[r]=t,t.parent=e},sb:function(t,e){delete t.Ia[e]},rb:function(t,e){var r,n=ht(t,e);for(r in n.Ia)throw new st(55);delete t.Ia[e]},pb:function(t){var e,r=[".",".."];for(e in t.Ia)t.Ia.hasOwnProperty(e)&&r.push(e);return r},ab:function(t,e,r){return(t=G.createNode(t,e,41471,0)).link=r,t},Xa:function(t){if(40960!=(61440&t.mode))throw new st(28);return t.link}},Ka:{read:function(t,e,r,n,a){var o=t.node.Ia;if(a>=t.node.La)return 0;if(8<(t=Math.min(t.node.La-a,n))&&o.subarray)e.set(o.subarray(a,a+t),r);else for(n=0;n<t;n++)e[r+n]=o[a+n];return t},write:function(t,e,r,n,a,o){if(e.buffer===p.buffer&&(o=!1),!n)return 0;if((t=t.node).timestamp=Date.now(),e.subarray&&(!t.Ia||t.Ia.subarray)){if(o)return t.Ia=e.subarray(r,r+n),t.La=n;if(0===t.La&&0===a)return t.Ia=e.slice(r,r+n),t.La=n;if(a+n<=t.La)return t.Ia.set(e.subarray(r,r+n),a),n}if(G.ib(t,a+n),t.Ia.subarray&&e.subarray)t.Ia.set(e.subarray(r,r+n),a);else for(o=0;o<n;o++)t.Ia[a+o]=e[r+o];return t.La=Math.max(t.La,a+n),n},Ua:function(t,e,r){if(1===r?e+=t.position:2===r&&32768==(61440&t.node.mode)&&(e+=t.node.La),0>e)throw new st(28);return e},gb:function(t,e,r){G.ib(t.node,e+r),t.node.La=Math.max(t.node.La,e+r)},mb:function(t,e,r,n,a,o,i){if(32768!=(61440&t.node.mode))throw new st(43);if(t=t.node.Ia,2&i||t.buffer!==e.buffer){if((0<a||a+n<t.length)&&(t=t.subarray?t.subarray(a,a+n):Array.prototype.slice.call(t,a,a+n)),a=!0,i=e.buffer==p.buffer,!(n=Ft(n)))throw new st(48);(i?p:e).set(t,n)}else a=!1,n=t.byteOffset;return{Nb:n,Bb:a}},ob:function(t,e,r,n,a){if(32768!=(61440&t.node.mode))throw new st(43);return 2&a||G.Ka.write(t,e,0,n,r,!1),0}}},tt=null,et={},rt=[],nt=1,at=null,ot=!0,it={},st=null,ft={};function ut(t,e){if(e=e||{},!(t=W("/",t)))return{path:"",node:null};var r,n={kb:!0,fb:0};for(r in n)void 0===e[r]&&(e[r]=n[r]);if(8<e.fb)throw new st(32);t=J(t.split("/").filter((function(t){return!!t})),!1);var a=tt;for(n="/",r=0;r<t.length;r++){var o=r===t.length-1;if(o&&e.parent)break;if(a=ht(a,t[r]),n=D(n+"/"+t[r]),a.Za&&(!o||o&&e.kb)&&(a=a.Za.root),!o||e.jb)for(o=0;40960==(61440&a.mode);)if(a=xt(n),a=ut(n=W(F(n),a),{fb:e.fb}).node,40<o++)throw new st(32)}return{path:n,node:a}}function ct(t){for(var e;;){if(t===t.parent)return t=t.Qa.nb,e?"/"!==t[t.length-1]?t+"/"+e:t+e:t;e=e?t.name+"/"+e:t.name,t=t.parent}}function lt(t,e){for(var r=0,n=0;n<e.length;n++)r=(r<<5)-r+e.charCodeAt(n)|0;return(t+r>>>0)%at.length}function ht(t,e){var r;if(r=(r=yt(t,"x"))?r:t.Ja.Wa?0:2)throw new st(r,t);for(r=at[lt(t.id,e)];r;r=r.xb){var n=r.name;if(r.parent.id===t.id&&n===e)return r}return t.Ja.Wa(t,e)}function _t(t,e,r,n){return e=lt((t=new jt(t,e,r,n)).parent.id,t.name),t.xb=at[e],at[e]=t}var pt={r:0,rs:1052672,"r+":2,w:577,wx:705,xw:705,"w+":578,"wx+":706,"xw+":706,a:1089,ax:1217,xa:1217,"a+":1090,"ax+":1218,"xa+":1218};function dt(t){var e=["r","w","rw"][3&t];return 512&t&&(e+="w"),e}function yt(t,e){return ot||(-1===e.indexOf("r")||292&t.mode)&&(-1===e.indexOf("w")||146&t.mode)&&(-1===e.indexOf("x")||73&t.mode)?0:2}function vt(t,e){try{return ht(t,e),20}catch(t){}return yt(t,"wx")}var wt,mt={open:function(t){t.Ka=et[t.node.$a].Ka,t.Ka.open&&t.Ka.open(t)},Ua:function(){throw new st(70)}};function bt(t,e){et[t]={Ka:e}}function gt(t,e){var r="/"===e,n=!e;if(r&&tt)throw new st(10);if(!r&&!n){var a=ut(e,{kb:!1});if(e=a.path,(a=a.node).Za)throw new st(10);if(16384!=(61440&a.mode))throw new st(54)}e={type:t,Mb:{},nb:e,wb:[]},(t=t.Qa(e)).Qa=e,e.root=t,r?tt=t:a&&(a.Za=e,a.Qa&&a.Qa.wb.push(e))}function Et(t,e,r){var n=ut(t,{parent:!0}).node;if(!(t=V(t))||"."===t||".."===t)throw new st(28);var a=vt(n,t);if(a)throw new st(a);if(!n.Ja.Ya)throw new st(63);return n.Ja.Ya(n,t,e,r)}function Pt(t){Et(t,16895,0)}function At(t,e,r){void 0===r&&(r=e,e=438),Et(t,8192|e,r)}function Tt(t,e){if(!W(t))throw new st(44);var r=ut(e,{parent:!0}).node;if(!r)throw new st(44);var n=vt(r,e=V(e));if(n)throw new st(n);if(!r.Ja.ab)throw new st(63);r.Ja.ab(r,e,t)}function xt(t){if(!(t=ut(t).node))throw new st(44);if(!t.Ja.Xa)throw new st(28);return W(ct(t.parent),t.Ja.Xa(t))}function Bt(t,r,n,a){if(""===t)throw new st(44);if("string"==typeof r){var o=pt[r];if(void 0===o)throw Error("Unknown file open mode: "+r);r=o}if(n=64&r?4095&(void 0===n?438:n)|32768:0,"object"==typeof t)var i=t;else{t=D(t);try{i=ut(t,{jb:!(131072&r)}).node}catch(t){}}if(o=!1,64&r)if(i){if(128&r)throw new st(20)}else i=Et(t,n,0),o=!0;if(!i)throw new st(44);if(8192==(61440&i.mode)&&(r&=-513),65536&r&&16384!=(61440&i.mode))throw new st(54);if(!o&&(n=i?40960==(61440&i.mode)?32:16384==(61440&i.mode)&&("r"!==dt(r)||512&r)?31:yt(i,dt(r)):44))throw new st(n);if(512&r){var s;if(!(s="string"==typeof(n=i)?ut(n,{jb:!0}).node:n).Ja.Pa)throw new st(63);if(16384==(61440&s.mode))throw new st(31);if(32768!=(61440&s.mode))throw new st(28);if(n=yt(s,"w"))throw new st(n);s.Ja.Pa(s,{size:0,timestamp:Date.now()})}r&=-641,(a=function(t,e){Ct||((Ct=function(){}).prototype={});var r,n=new Ct;for(r in t)n[r]=t[r];return t=n,e=function(t){for(t=t||0;t<=4096;t++)if(!rt[t])return t;throw new st(33)}(e),t.Sa=e,rt[e]=t}({node:i,path:ct(i),flags:r,seekable:!0,position:0,Ka:i.Ka,Ab:[],error:!1},a)).Ka.open&&a.Ka.open(a),!e.logReadFiles||1&r||(Rt||(Rt={}),t in Rt||(Rt[t]=1,f("FS.trackingDelegate error on read file: "+t)));try{it.onOpenFile&&(i=0,1!=(2097155&r)&&(i|=1),0!=(2097155&r)&&(i|=2),it.onOpenFile(t,i))}catch(e){f("FS.trackingDelegate['onOpenFile']('"+t+"', flags) threw an exception: "+e.message)}return a}function Mt(t,e,r){if(null===t.Sa)throw new st(8);if(!t.seekable||!t.Ka.Ua)throw new st(70);if(0!=r&&1!=r&&2!=r)throw new st(28);t.position=t.Ka.Ua(t,e,r),t.Ab=[]}function St(t,e,r,n){var a=p;if(0>r||0>n)throw new st(28);if(null===t.Sa)throw new st(8);if(1==(2097155&t.flags))throw new st(8);if(16384==(61440&t.node.mode))throw new st(31);if(!t.Ka.read)throw new st(28);var o=void 0!==n;if(o){if(!t.seekable)throw new st(70)}else n=t.position;return e=t.Ka.read(t,a,e,r,n),o||(t.position+=e),e}function It(){st||((st=function(t,e){this.node=e,this.zb=function(t){this.Ra=t},this.zb(t),this.message="FS error"}).prototype=Error(),st.prototype.constructor=st,[44].forEach((function(t){ft[t]=new st(t),ft[t].stack="<generic error, no stack>"})))}function Lt(t,e,r){t=D("/dev/"+t);var n=function(t,e){var r=0;return t&&(r|=365),e&&(r|=146),r}(!!e,!!r);kt||(kt=64);var a=kt++<<8|0;bt(a,{open:function(t){t.seekable=!1},close:function(){r&&r.buffer&&r.buffer.length&&r(10)},read:function(t,r,n,a){for(var o=0,i=0;i<a;i++){try{var s=e()}catch(t){throw new st(29)}if(void 0===s&&0===o)throw new st(6);if(null==s)break;o++,r[n+i]=s}return o&&(t.node.timestamp=Date.now()),o},write:function(t,e,n,a){for(var o=0;o<a;o++)try{r(e[n+o])}catch(t){throw new st(29)}return a&&(t.node.timestamp=Date.now()),o}}),At(t,n,a)}var kt,Ct,Rt,Ut={},Ot=void 0;function Kt(){return v[(Ot+=4)-4>>2]}function Nt(t){if(!(t=rt[t]))throw new st(8);return t}var zt=0;function jt(t,e,r,n){t||(t=this),this.parent=t,this.Qa=t.Qa,this.Za=null,this.id=nt++,this.name=e,this.mode=r,this.Ja={},this.Ka={},this.$a=n}Object.defineProperties(jt.prototype,{read:{get:function(){return 365==(365&this.mode)},set:function(t){t?this.mode|=365:this.mode&=-366}},write:{get:function(){return 146==(146&this.mode)},set:function(t){t?this.mode|=146:this.mode&=-147}}}),It(),at=Array(4096),gt(G,"/"),Pt("/tmp"),Pt("/home"),Pt("/home/web_user"),function(){if(Pt("/dev"),bt(259,{read:function(){return 0},write:function(t,e,r,n){return n}}),At("/dev/null",259),q(1280,$),q(1536,Z),At("/dev/tty",1280),At("/dev/tty1",1536),"object"==typeof crypto&&"function"==typeof crypto.getRandomValues)var t=new Uint8Array(1),e=function(){return crypto.getRandomValues(t),t[0]};e||(e=function(){O("random_device")}),Lt("random",e),Lt("urandom",e),Pt("/dev/shm"),Pt("/dev/shm/tmp")}(),Pt("/proc"),Pt("/proc/self"),Pt("/proc/self/fd"),gt({Qa:function(){var t=_t("/proc/self","fd",16895,73);return t.Ja={Wa:function(t,e){var r=rt[+e];if(!r)throw new st(8);return(t={parent:null,Qa:{nb:"fake"},Ja:{Xa:function(){return r.path}}}).parent=t}},t}},"/proc/self/fd");var Ht={w:function(t,r,n){Ot=n;try{var a=Nt(t);switch(r){case 0:var o=Kt();return 0>o?-28:Bt(a.path,a.flags,0,o).Sa;case 1:case 2:return 0;case 3:return a.flags;case 4:return o=Kt(),a.flags|=o,0;case 12:return o=Kt(),y[o+0>>1]=2,0;case 13:case 14:return 0;case 16:case 8:return-28;case 9:return e.___errno_location&&(v[e.___errno_location()>>2]=28),-1;default:return-28}}catch(t){return void 0!==Ut&&t instanceof st||O(t),-t.Ra}},D:function(t,e,r){try{return St(Nt(t),e,r)}catch(t){return void 0!==Ut&&t instanceof st||O(t),-t.Ra}},z:function(t,e,r){Ot=r;try{return Bt(t?g(d,t,void 0):"",e,Kt()).Sa}catch(t){return void 0!==Ut&&t instanceof st||O(t),-t.Ra}},C:function(t,e,r){Ot=r;try{var n=Nt(t);switch(e){case 21509:case 21505:return n.Ma?0:-59;case 21510:case 21511:case 21512:case 21506:case 21507:case 21508:return n.Ma?0:-59;case 21519:if(!n.Ma)return-59;var a=Kt();return v[a>>2]=0;case 21520:return n.Ma?-28:-59;case 21531:if(t=a=Kt(),!n.Ka.vb)throw new st(59);return n.Ka.vb(n,e,t);case 21523:case 21524:return n.Ma?0:-59;default:O("bad ioctl syscall "+e)}}catch(t){return void 0!==Ut&&t instanceof st||O(t),-t.Ra}},t:function(){O()},h:function(t,e){throw Dt(t,e||1),"longjmp"},E:function(t,e,r){d.copyWithin(t,e,e+r)},F:function(t){var e=d.length;if(2147418112<t)return!1;for(var r=1;4>=r;r*=2){var n=e*(1+.2/r);n=Math.min(n,t+100663296),0<(n=Math.max(16777216,t,n))%65536&&(n+=65536-n%65536);t:{try{h.grow(Math.min(2147418112,n)-_.byteLength+65535>>16),E(h.buffer);var a=1;break t}catch(t){}a=void 0}if(a)return!0}return!1},m:function(t){!c&&(m=!0,e.onExit)&&e.onExit(t),o(t,new ce(t))},s:function(t){try{var e=Nt(t);if(null===e.Sa)throw new st(8);e.cb&&(e.cb=null);try{e.Ka.close&&e.Ka.close(e)}catch(t){throw t}finally{rt[e.Sa]=null}return e.Sa=null,0}catch(t){return void 0!==Ut&&t instanceof st||O(t),t.Ra}},B:function(t,e,r,n){try{t:{for(var a=Nt(t),o=t=0;o<r;o++){var i=v[e+(8*o+4)>>2],s=St(a,v[e+8*o>>2],i,void 0);if(0>s){var f=-1;break t}if(t+=s,s<i)break}f=t}return v[n>>2]=f,0}catch(t){return void 0!==Ut&&t instanceof st||O(t),t.Ra}},A:function(t,e,r,n,a){try{var o=Nt(t);return-9007199254740992>=(t=4294967296*r+(e>>>0))||9007199254740992<=t?-61:(Mt(o,t,n),z=[o.position>>>0,(N=o.position,1<=+I(N)?0<N?(0|C(+k(N/4294967296),4294967295))>>>0:~~+L((N-+(~~N>>>0))/4294967296)>>>0:0)],v[a>>2]=z[0],v[a+4>>2]=z[1],o.cb&&0===t&&0===n&&(o.cb=null),0)}catch(t){return void 0!==Ut&&t instanceof st||O(t),t.Ra}},v:function(t,e,r,n){try{t:{for(var a=Nt(t),o=t=0;o<r;o++){var i=a,s=v[e+8*o>>2],u=v[e+(8*o+4)>>2],c=void 0,l=p;if(0>u||0>c)throw new st(28);if(null===i.Sa)throw new st(8);if(0==(2097155&i.flags))throw new st(8);if(16384==(61440&i.node.mode))throw new st(31);if(!i.Ka.write)throw new st(28);1024&i.flags&&Mt(i,0,2);var h=void 0!==c;if(h){if(!i.seekable)throw new st(70)}else c=i.position;var _=i.Ka.write(i,l,s,u,c,void 0);h||(i.position+=_);try{i.path&&it.onWriteToFile&&it.onWriteToFile(i.path)}catch(t){f("FS.trackingDelegate['onWriteToFile']('"+i.path+"') threw an exception: "+t.message)}var d=_;if(0>d){var y=-1;break t}t+=d}y=t}return v[n>>2]=y,0}catch(t){return void 0!==Ut&&t instanceof st||O(t),t.Ra}},a:function(){return 0|l},x:function(t){var e=Date.now();return v[t>>2]=e/1e3|0,v[t+4>>2]=e%1e3*1e3|0,0},g:function(t){var e=se();try{return re(t)}catch(t){if(ue(e),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},j:function(t,e){var r=se();try{return ne(t,e)}catch(t){if(ue(r),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},i:function(t,e,r){var n=se();try{return ae(t,e,r)}catch(t){if(ue(n),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},q:function(t,e,r,n){var a=se();try{return oe(t,e,r,n)}catch(t){if(ue(a),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},y:function(t,e,r,n,a){var o=se();try{return ie(t,e,r,n,a)}catch(t){if(ue(o),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},n:function(t){var e=se();try{Wt(t)}catch(t){if(ue(e),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},e:function(t,e){var r=se();try{Qt(t,e)}catch(t){if(ue(r),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},d:function(t,e,r){var n=se();try{qt(t,e,r)}catch(t){if(ue(n),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},f:function(t,e,r,n){var a=se();try{Xt(t,e,r,n)}catch(t){if(ue(a),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},l:function(t,e,r,n,a){var o=se();try{$t(t,e,r,n,a)}catch(t){if(ue(o),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},o:function(t,e,r,n,a,o){var i=se();try{Zt(t,e,r,n,a,o)}catch(t){if(ue(i),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},p:function(t,e,r,n,a,o,i){var s=se();try{Gt(t,e,r,n,a,o,i)}catch(t){if(ue(s),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},r:function(t,e,r,n,a,o,i,s){var f=se();try{te(t,e,r,n,a,o,i,s)}catch(t){if(ue(f),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},u:function(t,e,r,n,a,o,i,s,f){var u=se();try{ee(t,e,r,n,a,o,i,s,f)}catch(t){if(ue(u),t!==t+0&&"longjmp"!==t)throw t;Dt(1,0)}},memory:h,k:function t(e,r,n,a){r|=0,n|=0,a|=0;var o=0;for(zt=zt+1|0,v[(e|=0)>>2]=zt;(0|o)<(0|a);){if(0==(0|v[n+(o<<3)>>2]))return v[n+(o<<3)>>2]=zt,v[n+(4+(o<<3))>>2]=r,v[n+(8+(o<<3))>>2]=0,l=0|a,0|n;o=o+1|0}return n=0|t(0|e,0|r,0|(n=0|Vt(0|n,8*(1+(a=2*a|0)|0)|0)),0|a),l=0|a,0|n},b:function(t){l=0|t},table:w,c:function(t,e,r){t|=0,e|=0,r|=0;for(var n,a=0;(0|a)<(0|r)&&0!=(0|(n=0|v[e+(a<<3)>>2]));){if((0|n)==(0|t))return 0|v[e+(4+(a<<3))>>2];a=a+1|0}return 0}},Yt=function(){function t(t){e.asm=t.exports,R--,e.monitorRunDependencies&&e.monitorRunDependencies(R),0==R&&U&&(t=U,U=null,t())}function r(e){t(e.instance)}function n(t){return(u||"function"!=typeof fetch?new Promise((function(t){t(Y())})):fetch(j,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+j+"'";return t.arrayBuffer()})).catch((function(){return Y()}))).then((function(t){return WebAssembly.instantiate(t,a)})).then(t,(function(t){f("failed to asynchronously prepare wasm: "+t),O(t)}))}var a={a:Ht};if(R++,e.monitorRunDependencies&&e.monitorRunDependencies(R),e.instantiateWasm)try{return e.instantiateWasm(a,t)}catch(t){return f("Module.instantiateWasm callback failed with error: "+t),!1}return function(){if(u||"function"!=typeof WebAssembly.instantiateStreaming||K()||"function"!=typeof fetch)return n(r);fetch(j,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,a).then(r,(function(t){f("wasm streaming compile failed: "+t),f("falling back to ArrayBuffer instantiation"),n(r)}))}))}(),{}}();e.asm=Yt;var Jt=e.___wasm_call_ctors=function(){return(Jt=e.___wasm_call_ctors=e.asm.G).apply(null,arguments)};e._vscp_error_ctx_size=function(){return(e._vscp_error_ctx_size=e.asm.H).apply(null,arguments)},e._vscp_error_reset=function(){return(e._vscp_error_reset=e.asm.I).apply(null,arguments)},e._vscp_error_status=function(){return(e._vscp_error_status=e.asm.J).apply(null,arguments)},e._vscp_pythia_configure=function(){return(e._vscp_pythia_configure=e.asm.K).apply(null,arguments)},e._vscp_pythia_cleanup=function(){return(e._vscp_pythia_cleanup=e.asm.L).apply(null,arguments)},e._vscp_pythia_blinded_password_buf_len=function(){return(e._vscp_pythia_blinded_password_buf_len=e.asm.M).apply(null,arguments)},e._vscp_pythia_deblinded_password_buf_len=function(){return(e._vscp_pythia_deblinded_password_buf_len=e.asm.N).apply(null,arguments)},e._vscp_pythia_blinding_secret_buf_len=function(){return(e._vscp_pythia_blinding_secret_buf_len=e.asm.O).apply(null,arguments)},e._vscp_pythia_transformation_private_key_buf_len=function(){return(e._vscp_pythia_transformation_private_key_buf_len=e.asm.P).apply(null,arguments)},e._vscp_pythia_transformation_public_key_buf_len=function(){return(e._vscp_pythia_transformation_public_key_buf_len=e.asm.Q).apply(null,arguments)},e._vscp_pythia_transformed_password_buf_len=function(){return(e._vscp_pythia_transformed_password_buf_len=e.asm.R).apply(null,arguments)},e._vscp_pythia_transformed_tweak_buf_len=function(){return(e._vscp_pythia_transformed_tweak_buf_len=e.asm.S).apply(null,arguments)},e._vscp_pythia_proof_value_buf_len=function(){return(e._vscp_pythia_proof_value_buf_len=e.asm.T).apply(null,arguments)},e._vscp_pythia_password_update_token_buf_len=function(){return(e._vscp_pythia_password_update_token_buf_len=e.asm.U).apply(null,arguments)},e._vscp_pythia_blind=function(){return(e._vscp_pythia_blind=e.asm.V).apply(null,arguments)},e._vscp_pythia_deblind=function(){return(e._vscp_pythia_deblind=e.asm.W).apply(null,arguments)},e._vscp_pythia_compute_transformation_key_pair=function(){return(e._vscp_pythia_compute_transformation_key_pair=e.asm.X).apply(null,arguments)},e._vscp_pythia_transform=function(){return(e._vscp_pythia_transform=e.asm.Y).apply(null,arguments)},e._vscp_pythia_prove=function(){return(e._vscp_pythia_prove=e.asm.Z).apply(null,arguments)},e._vscp_pythia_verify=function(){return(e._vscp_pythia_verify=e.asm._).apply(null,arguments)},e._vscp_pythia_get_password_update_token=function(){return(e._vscp_pythia_get_password_update_token=e.asm.$).apply(null,arguments)},e._vscp_pythia_update_deblinded_with_token=function(){return(e._vscp_pythia_update_deblinded_with_token=e.asm.aa).apply(null,arguments)},e._vsc_buffer_new=function(){return(e._vsc_buffer_new=e.asm.ba).apply(null,arguments)},e._vsc_buffer_new_with_capacity=function(){return(e._vsc_buffer_new_with_capacity=e.asm.ca).apply(null,arguments)},e._vsc_buffer_delete=function(){return(e._vsc_buffer_delete=e.asm.da).apply(null,arguments)},e._vsc_buffer_data=function(){return(e._vsc_buffer_data=e.asm.ea).apply(null,arguments)},e._vsc_buffer_make_secure=function(){return(e._vsc_buffer_make_secure=e.asm.fa).apply(null,arguments)},e._vsc_buffer_bytes=function(){return(e._vsc_buffer_bytes=e.asm.ga).apply(null,arguments)},e._vsc_buffer_len=function(){return(e._vsc_buffer_len=e.asm.ha).apply(null,arguments)},e._vsc_data_ctx_size=function(){return(e._vsc_data_ctx_size=e.asm.ia).apply(null,arguments)},e._vsc_data=function(){return(e._vsc_data=e.asm.ja).apply(null,arguments)},e._vsc_data_len=function(){return(e._vsc_data_len=e.asm.ka).apply(null,arguments)},e._vsc_data_bytes=function(){return(e._vsc_data_bytes=e.asm.la).apply(null,arguments)},e.___errno_location=function(){return(e.___errno_location=e.asm.ma).apply(null,arguments)};var Dt=e._setThrew=function(){return(Dt=e._setThrew=e.asm.na).apply(null,arguments)},Ft=e._malloc=function(){return(Ft=e._malloc=e.asm.oa).apply(null,arguments)};e._free=function(){return(e._free=e.asm.pa).apply(null,arguments)};var Vt=e._realloc=function(){return(Vt=e._realloc=e.asm.qa).apply(null,arguments)},Wt=e.dynCall_v=function(){return(Wt=e.dynCall_v=e.asm.ra).apply(null,arguments)},Qt=e.dynCall_vi=function(){return(Qt=e.dynCall_vi=e.asm.sa).apply(null,arguments)},qt=e.dynCall_vii=function(){return(qt=e.dynCall_vii=e.asm.ta).apply(null,arguments)},Xt=e.dynCall_viii=function(){return(Xt=e.dynCall_viii=e.asm.ua).apply(null,arguments)},$t=e.dynCall_viiii=function(){return($t=e.dynCall_viiii=e.asm.va).apply(null,arguments)},Zt=e.dynCall_viiiii=function(){return(Zt=e.dynCall_viiiii=e.asm.wa).apply(null,arguments)},Gt=e.dynCall_viiiiii=function(){return(Gt=e.dynCall_viiiiii=e.asm.xa).apply(null,arguments)},te=e.dynCall_viiiiiii=function(){return(te=e.dynCall_viiiiiii=e.asm.ya).apply(null,arguments)},ee=e.dynCall_viiiiiiii=function(){return(ee=e.dynCall_viiiiiiii=e.asm.za).apply(null,arguments)},re=e.dynCall_i=function(){return(re=e.dynCall_i=e.asm.Aa).apply(null,arguments)},ne=e.dynCall_ii=function(){return(ne=e.dynCall_ii=e.asm.Ba).apply(null,arguments)},ae=e.dynCall_iii=function(){return(ae=e.dynCall_iii=e.asm.Ca).apply(null,arguments)},oe=e.dynCall_iiii=function(){return(oe=e.dynCall_iiii=e.asm.Da).apply(null,arguments)},ie=e.dynCall_iiiii=function(){return(ie=e.dynCall_iiiii=e.asm.Ea).apply(null,arguments)},se=e.stackSave=function(){return(se=e.stackSave=e.asm.Fa).apply(null,arguments)};e.stackAlloc=function(){return(e.stackAlloc=e.asm.Ga).apply(null,arguments)};var fe,ue=e.stackRestore=function(){return(ue=e.stackRestore=e.asm.Ha).apply(null,arguments)};function ce(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function le(){function t(){if(!fe&&(fe=!0,e.calledRun=!0,!m)){if(e.noFSInit||wt||(wt=!0,It(),e.stdin=e.stdin,e.stdout=e.stdout,e.stderr=e.stderr,e.stdin?Lt("stdin",e.stdin):Tt("/dev/tty","/dev/stdin"),e.stdout?Lt("stdout",null,e.stdout):Tt("/dev/tty","/dev/stdout"),e.stderr?Lt("stderr",null,e.stderr):Tt("/dev/tty1","/dev/stderr"),Bt("/dev/stdin","r"),Bt("/dev/stdout","w"),Bt("/dev/stderr","w")),A(x),ot=!1,A(B),e.onRuntimeInitialized&&e.onRuntimeInitialized(),e.postRun)for("function"==typeof e.postRun&&(e.postRun=[e.postRun]);e.postRun.length;){var t=e.postRun.shift();M.unshift(t)}A(M)}}if(!(0<R)){if(e.preRun)for("function"==typeof e.preRun&&(e.preRun=[e.preRun]);e.preRun.length;)S();A(T),0<R||(e.setStatus?(e.setStatus("Running..."),setTimeout((function(){setTimeout((function(){e.setStatus("")}),1),t()}),1)):t())}}if(e.asm=Yt,e.then=function(t){if(fe)t(e);else{var r=e.onRuntimeInitialized;e.onRuntimeInitialized=function(){r&&r(),t(e)}}return e},U=function t(){fe||le(),fe||(U=t)},e.run=le,e.preInit)for("function"==typeof e.preInit&&(e.preInit=[e.preInit]);0<e.preInit.length;)e.preInit.pop()();return c=!0,le(),t});t.exports=n}(e={exports:{}}),e.exports}(),r=(t,e)=>{class r extends Error{constructor(t){super(t),this.name="PythiaError",this.message=t}static handleStatusCode(t){if(0!=t){if(-1==t)throw new r("This error should not be returned if assertions is enabled.");if(-200==t)throw new r("Underlying pythia library returns -1.");if(-202==t)throw new r("Underlying random number generator failed.");throw new r("Unexpected status code:"+t)}}}return r};var n=function(t,e){if(!(e instanceof Uint8Array))throw new TypeError(`'${t}' is not an Uint8Array`)};var a,o=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t){var e=Object.prototype.hasOwnProperty,r="~";function n(){}function a(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function o(t,e,n,o,i){if("function"!=typeof n)throw new TypeError("The listener must be a function");var s=new a(n,o||t,i),f=r?r+e:e;return t._events[f]?t._events[f].fn?t._events[f]=[t._events[f],s]:t._events[f].push(s):(t._events[f]=s,t._eventsCount++),t}function i(t,e){0==--t._eventsCount?t._events=new n:delete t._events[e]}function s(){this._events=new n,this._eventsCount=0}Object.create&&(n.prototype=Object.create(null),(new n).__proto__||(r=!1)),s.prototype.eventNames=function(){var t,n,a=[];if(0===this._eventsCount)return a;for(n in t=this._events)e.call(t,n)&&a.push(r?n.slice(1):n);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(t)):a},s.prototype.listeners=function(t){var e=r?r+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var a=0,o=n.length,i=new Array(o);a<o;a++)i[a]=n[a].fn;return i},s.prototype.listenerCount=function(t){var e=r?r+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,a,o,i){var s=r?r+t:t;if(!this._events[s])return!1;var f,u,c=this._events[s],l=arguments.length;if(c.fn){switch(c.once&&this.removeListener(t,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,e),!0;case 3:return c.fn.call(c.context,e,n),!0;case 4:return c.fn.call(c.context,e,n,a),!0;case 5:return c.fn.call(c.context,e,n,a,o),!0;case 6:return c.fn.call(c.context,e,n,a,o,i),!0}for(u=1,f=new Array(l-1);u<l;u++)f[u-1]=arguments[u];c.fn.apply(c.context,f)}else{var h,_=c.length;for(u=0;u<_;u++)switch(c[u].once&&this.removeListener(t,c[u].fn,void 0,!0),l){case 1:c[u].fn.call(c[u].context);break;case 2:c[u].fn.call(c[u].context,e);break;case 3:c[u].fn.call(c[u].context,e,n);break;case 4:c[u].fn.call(c[u].context,e,n,a);break;default:if(!f)for(h=1,f=new Array(l-1);h<l;h++)f[h-1]=arguments[h];c[u].fn.apply(c[u].context,f)}}return!0},s.prototype.on=function(t,e,r){return o(this,t,e,r,!1)},s.prototype.once=function(t,e,r){return o(this,t,e,r,!0)},s.prototype.removeListener=function(t,e,n,a){var o=r?r+t:t;if(!this._events[o])return this;if(!e)return i(this,o),this;var s=this._events[o];if(s.fn)s.fn!==e||a&&!s.once||n&&s.context!==n||i(this,o);else{for(var f=0,u=[],c=s.length;f<c;f++)(s[f].fn!==e||a&&!s[f].once||n&&s[f].context!==n)&&u.push(s[f]);u.length?this._events[o]=1===u.length?u[0]:u:i(this,o)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=r?r+t:t,this._events[e]&&i(this,e)):(this._events=new n,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=r,s.EventEmitter=s,t.exports=s}));class i extends Error{constructor(){super("Module already exists."),Object.setPrototypeOf(this,i.prototype),this.name="ModuleAlreadyExistsError"}}class s extends Error{constructor(){super("Module not found."),Object.setPrototypeOf(this,s.prototype),this.name="ModuleNotFoundError"}}!function(t){t.load="load",t.remove="remove",t.error="error"}(a||(a={}));const f=new class extends o{constructor(){super(...arguments),this.initFns=new Map,this.initPromises=new Map,this.modules=new Map,this.addModule=(t,e)=>{if(this.initFns.has(t)){const r=new i;throw this.emit(a.error,r,t,e),r}this.loadModulesPromise=void 0,this.initFns.set(t,e)},this.getModule=t=>{if(!this.modules.has(t)){const e=new s;throw this.emit(a.error,e,t),e}return this.modules.get(t)},this.hasModule=t=>this.modules.has(t),this.setModule=(t,e)=>{this.modules.set(t,e),this.emit(a.load,t,e)},this.removeModule=t=>{if(this.initFns.delete(t),this.initPromises.delete(t),this.modules.has(t)){const e=this.modules.get(t);this.modules.delete(t),this.emit(a.remove,t,e)}},this.loadModule=(t,...e)=>{if(!this.initFns.has(t)){const r=new s;throw this.emit(a.error,r,t,...e),r}if(this.initPromises.has(t))return this.initPromises.get(t);const r=this.initFns.get(t)(...e).then(r=>(this.modules.set(t,r),this.emit(a.load,t,r,...e),Promise.resolve()));return this.initPromises.set(t,r),r},this.loadModules=t=>{if(this.loadModulesPromise)return this.loadModulesPromise;const e=t||{},r=Array.from(this.initFns.keys()).map(t=>e[t]?this.loadModule(t,...e[t]):this.loadModule(t));return this.loadModulesPromise=Promise.all(r).then(()=>Promise.resolve()),this.loadModulesPromise}}};f.addModule("pythia",t=>{const a=new e(t);return new Promise((t,e)=>{a.onRuntimeInitialized=()=>{const e={};e.PythiaError=r(),e.Pythia=((t,e)=>class{static configure(){const r=t._vscp_pythia_configure();e.PythiaError.handleStatusCode(r)}static cleanup(){t._vscp_pythia_cleanup()}static blindedPasswordBufLen(){let e;return e=t._vscp_pythia_blinded_password_buf_len(),e}static deblindedPasswordBufLen(){let e;return e=t._vscp_pythia_deblinded_password_buf_len(),e}static blindingSecretBufLen(){let e;return e=t._vscp_pythia_blinding_secret_buf_len(),e}static transformationPrivateKeyBufLen(){let e;return e=t._vscp_pythia_transformation_private_key_buf_len(),e}static transformationPublicKeyBufLen(){let e;return e=t._vscp_pythia_transformation_public_key_buf_len(),e}static transformedPasswordBufLen(){let e;return e=t._vscp_pythia_transformed_password_buf_len(),e}static transformedTweakBufLen(){let e;return e=t._vscp_pythia_transformed_tweak_buf_len(),e}static proofValueBufLen(){let e;return e=t._vscp_pythia_proof_value_buf_len(),e}static passwordUpdateTokenBufLen(){let e;return e=t._vscp_pythia_password_update_token_buf_len(),e}static blind(r){n("password",r);const a=r.length*r.BYTES_PER_ELEMENT,o=t._malloc(a);t.HEAP8.set(r,o);const i=t._vsc_data_ctx_size(),s=t._malloc(i);t._vsc_data(s,o,a);const f=e.Pythia.blindedPasswordBufLen(),u=t._vsc_buffer_new_with_capacity(f),c=e.Pythia.blindingSecretBufLen(),l=t._vsc_buffer_new_with_capacity(c);try{const r=t._vscp_pythia_blind(s,u,l);e.PythiaError.handleStatusCode(r);const n=t._vsc_buffer_bytes(u),a=t._vsc_buffer_len(u),i=t.HEAPU8.slice(n,n+a),f=t._vsc_buffer_bytes(l),c=t._vsc_buffer_len(l);return{blindedPassword:i,blindingSecret:t.HEAPU8.slice(f,f+c)}}finally{t._free(o),t._free(s),t._vsc_buffer_delete(u),t._vsc_buffer_delete(l)}}static deblind(r,a){n("transformedPassword",r),n("blindingSecret",a);const o=r.length*r.BYTES_PER_ELEMENT,i=t._malloc(o);t.HEAP8.set(r,i);const s=t._vsc_data_ctx_size(),f=t._malloc(s);t._vsc_data(f,i,o);const u=a.length*a.BYTES_PER_ELEMENT,c=t._malloc(u);t.HEAP8.set(a,c);const l=t._vsc_data_ctx_size(),h=t._malloc(l);t._vsc_data(h,c,u);const _=e.Pythia.deblindedPasswordBufLen(),p=t._vsc_buffer_new_with_capacity(_);try{const r=t._vscp_pythia_deblind(f,h,p);e.PythiaError.handleStatusCode(r);const n=t._vsc_buffer_bytes(p),a=t._vsc_buffer_len(p);return t.HEAPU8.slice(n,n+a)}finally{t._free(i),t._free(f),t._free(c),t._free(h),t._vsc_buffer_delete(p)}}static computeTransformationKeyPair(r,a,o){n("transformationKeyId",r),n("pythiaSecret",a),n("pythiaScopeSecret",o);const i=r.length*r.BYTES_PER_ELEMENT,s=t._malloc(i);t.HEAP8.set(r,s);const f=t._vsc_data_ctx_size(),u=t._malloc(f);t._vsc_data(u,s,i);const c=a.length*a.BYTES_PER_ELEMENT,l=t._malloc(c);t.HEAP8.set(a,l);const h=t._vsc_data_ctx_size(),_=t._malloc(h);t._vsc_data(_,l,c);const p=o.length*o.BYTES_PER_ELEMENT,d=t._malloc(p);t.HEAP8.set(o,d);const y=t._vsc_data_ctx_size(),v=t._malloc(y);t._vsc_data(v,d,p);const w=e.Pythia.transformationPrivateKeyBufLen(),m=t._vsc_buffer_new_with_capacity(w),b=e.Pythia.transformationPublicKeyBufLen(),g=t._vsc_buffer_new_with_capacity(b);try{const r=t._vscp_pythia_compute_transformation_key_pair(u,_,v,m,g);e.PythiaError.handleStatusCode(r);const n=t._vsc_buffer_bytes(m),a=t._vsc_buffer_len(m),o=t.HEAPU8.slice(n,n+a),i=t._vsc_buffer_bytes(g),f=t._vsc_buffer_len(g);return{transformationPrivateKey:o,transformationPublicKey:t.HEAPU8.slice(i,i+f)}}finally{t._free(s),t._free(u),t._free(l),t._free(_),t._free(d),t._free(v),t._vsc_buffer_delete(m),t._vsc_buffer_delete(g)}}static transform(r,a,o){n("blindedPassword",r),n("tweak",a),n("transformationPrivateKey",o);const i=r.length*r.BYTES_PER_ELEMENT,s=t._malloc(i);t.HEAP8.set(r,s);const f=t._vsc_data_ctx_size(),u=t._malloc(f);t._vsc_data(u,s,i);const c=a.length*a.BYTES_PER_ELEMENT,l=t._malloc(c);t.HEAP8.set(a,l);const h=t._vsc_data_ctx_size(),_=t._malloc(h);t._vsc_data(_,l,c);const p=o.length*o.BYTES_PER_ELEMENT,d=t._malloc(p);t.HEAP8.set(o,d);const y=t._vsc_data_ctx_size(),v=t._malloc(y);t._vsc_data(v,d,p);const w=e.Pythia.transformedPasswordBufLen(),m=t._vsc_buffer_new_with_capacity(w),b=e.Pythia.transformedTweakBufLen(),g=t._vsc_buffer_new_with_capacity(b);try{const r=t._vscp_pythia_transform(u,_,v,m,g);e.PythiaError.handleStatusCode(r);const n=t._vsc_buffer_bytes(m),a=t._vsc_buffer_len(m),o=t.HEAPU8.slice(n,n+a),i=t._vsc_buffer_bytes(g),f=t._vsc_buffer_len(g);return{transformedPassword:o,transformedTweak:t.HEAPU8.slice(i,i+f)}}finally{t._free(s),t._free(u),t._free(l),t._free(_),t._free(d),t._free(v),t._vsc_buffer_delete(m),t._vsc_buffer_delete(g)}}static prove(r,a,o,i,s){n("transformedPassword",r),n("blindedPassword",a),n("transformedTweak",o),n("transformationPrivateKey",i),n("transformationPublicKey",s);const f=r.length*r.BYTES_PER_ELEMENT,u=t._malloc(f);t.HEAP8.set(r,u);const c=t._vsc_data_ctx_size(),l=t._malloc(c);t._vsc_data(l,u,f);const h=a.length*a.BYTES_PER_ELEMENT,_=t._malloc(h);t.HEAP8.set(a,_);const p=t._vsc_data_ctx_size(),d=t._malloc(p);t._vsc_data(d,_,h);const y=o.length*o.BYTES_PER_ELEMENT,v=t._malloc(y);t.HEAP8.set(o,v);const w=t._vsc_data_ctx_size(),m=t._malloc(w);t._vsc_data(m,v,y);const b=i.length*i.BYTES_PER_ELEMENT,g=t._malloc(b);t.HEAP8.set(i,g);const E=t._vsc_data_ctx_size(),P=t._malloc(E);t._vsc_data(P,g,b);const A=s.length*s.BYTES_PER_ELEMENT,T=t._malloc(A);t.HEAP8.set(s,T);const x=t._vsc_data_ctx_size(),B=t._malloc(x);t._vsc_data(B,T,A);const M=e.Pythia.proofValueBufLen(),S=t._vsc_buffer_new_with_capacity(M),I=e.Pythia.proofValueBufLen(),L=t._vsc_buffer_new_with_capacity(I);try{const r=t._vscp_pythia_prove(l,d,m,P,B,S,L);e.PythiaError.handleStatusCode(r);const n=t._vsc_buffer_bytes(S),a=t._vsc_buffer_len(S),o=t.HEAPU8.slice(n,n+a),i=t._vsc_buffer_bytes(L),s=t._vsc_buffer_len(L);return{proofValueC:o,proofValueU:t.HEAPU8.slice(i,i+s)}}finally{t._free(u),t._free(l),t._free(_),t._free(d),t._free(v),t._free(m),t._free(g),t._free(P),t._free(T),t._free(B),t._vsc_buffer_delete(S),t._vsc_buffer_delete(L)}}static verify(r,a,o,i,s,f){n("transformedPassword",r),n("blindedPassword",a),n("tweak",o),n("transformationPublicKey",i),n("proofValueC",s),n("proofValueU",f);const u=r.length*r.BYTES_PER_ELEMENT,c=t._malloc(u);t.HEAP8.set(r,c);const l=t._vsc_data_ctx_size(),h=t._malloc(l);t._vsc_data(h,c,u);const _=a.length*a.BYTES_PER_ELEMENT,p=t._malloc(_);t.HEAP8.set(a,p);const d=t._vsc_data_ctx_size(),y=t._malloc(d);t._vsc_data(y,p,_);const v=o.length*o.BYTES_PER_ELEMENT,w=t._malloc(v);t.HEAP8.set(o,w);const m=t._vsc_data_ctx_size(),b=t._malloc(m);t._vsc_data(b,w,v);const g=i.length*i.BYTES_PER_ELEMENT,E=t._malloc(g);t.HEAP8.set(i,E);const P=t._vsc_data_ctx_size(),A=t._malloc(P);t._vsc_data(A,E,g);const T=s.length*s.BYTES_PER_ELEMENT,x=t._malloc(T);t.HEAP8.set(s,x);const B=t._vsc_data_ctx_size(),M=t._malloc(B);t._vsc_data(M,x,T);const S=f.length*f.BYTES_PER_ELEMENT,I=t._malloc(S);t.HEAP8.set(f,I);const L=t._vsc_data_ctx_size(),k=t._malloc(L);t._vsc_data(k,I,S);const C=t._vscp_error_ctx_size(),R=t._malloc(C);let U;t._vscp_error_reset(R);try{U=t._vscp_pythia_verify(h,y,b,A,M,k,R);const r=t._vscp_error_status(R);return e.PythiaError.handleStatusCode(r),!!U}finally{t._free(c),t._free(h),t._free(p),t._free(y),t._free(w),t._free(b),t._free(E),t._free(A),t._free(x),t._free(M),t._free(I),t._free(k),t._free(R)}}static getPasswordUpdateToken(r,a){n("previousTransformationPrivateKey",r),n("newTransformationPrivateKey",a);const o=r.length*r.BYTES_PER_ELEMENT,i=t._malloc(o);t.HEAP8.set(r,i);const s=t._vsc_data_ctx_size(),f=t._malloc(s);t._vsc_data(f,i,o);const u=a.length*a.BYTES_PER_ELEMENT,c=t._malloc(u);t.HEAP8.set(a,c);const l=t._vsc_data_ctx_size(),h=t._malloc(l);t._vsc_data(h,c,u);const _=e.Pythia.passwordUpdateTokenBufLen(),p=t._vsc_buffer_new_with_capacity(_);try{const r=t._vscp_pythia_get_password_update_token(f,h,p);e.PythiaError.handleStatusCode(r);const n=t._vsc_buffer_bytes(p),a=t._vsc_buffer_len(p);return t.HEAPU8.slice(n,n+a)}finally{t._free(i),t._free(f),t._free(c),t._free(h),t._vsc_buffer_delete(p)}}static updateDeblindedWithToken(r,a){n("deblindedPassword",r),n("passwordUpdateToken",a);const o=r.length*r.BYTES_PER_ELEMENT,i=t._malloc(o);t.HEAP8.set(r,i);const s=t._vsc_data_ctx_size(),f=t._malloc(s);t._vsc_data(f,i,o);const u=a.length*a.BYTES_PER_ELEMENT,c=t._malloc(u);t.HEAP8.set(a,c);const l=t._vsc_data_ctx_size(),h=t._malloc(l);t._vsc_data(h,c,u);const _=e.Pythia.deblindedPasswordBufLen(),p=t._vsc_buffer_new_with_capacity(_);try{const r=t._vscp_pythia_update_deblinded_with_token(f,h,p);e.PythiaError.handleStatusCode(r);const n=t._vsc_buffer_bytes(p),a=t._vsc_buffer_len(p);return t.HEAPU8.slice(n,n+a)}finally{t._free(i),t._free(f),t._free(c),t._free(h),t._vsc_buffer_delete(p)}}})(a,e),t(e)},a.onAbort=t=>{e(new Error(t))}})}),f.on("load",(t,e)=>{if("pythia"===t)try{e.Pythia.configure()}catch(t){throw e.Pythia.cleanup(),t}}),f.on("remove",(t,e)=>{"pythia"===t&&e.Pythia.cleanup()});const u=()=>f.getModule("pythia"),c=f.loadModules;for(var l=function(t){var e=b(t),r=e[0],n=e[1];return 3*(r+n)/4-n},h=function(t){var e,r,n=b(t),a=n[0],o=n[1],i=new y(function(t,e,r){return 3*(e+r)/4-r}(0,a,o)),s=0,f=o>0?a-4:a;for(r=0;r<f;r+=4)e=d[t.charCodeAt(r)]<<18|d[t.charCodeAt(r+1)]<<12|d[t.charCodeAt(r+2)]<<6|d[t.charCodeAt(r+3)],i[s++]=e>>16&255,i[s++]=e>>8&255,i[s++]=255&e;2===o&&(e=d[t.charCodeAt(r)]<<2|d[t.charCodeAt(r+1)]>>4,i[s++]=255&e);1===o&&(e=d[t.charCodeAt(r)]<<10|d[t.charCodeAt(r+1)]<<4|d[t.charCodeAt(r+2)]>>2,i[s++]=e>>8&255,i[s++]=255&e);return i},_=function(t){for(var e,r=t.length,n=r%3,a=[],o=0,i=r-n;o<i;o+=16383)a.push(g(t,o,o+16383>i?i:o+16383));1===n?(e=t[r-1],a.push(p[e>>2]+p[e<<4&63]+"==")):2===n&&(e=(t[r-2]<<8)+t[r-1],a.push(p[e>>10]+p[e>>4&63]+p[e<<2&63]+"="));return a.join("")},p=[],d=[],y="undefined"!=typeof Uint8Array?Uint8Array:Array,v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=0,m=v.length;w<m;++w)p[w]=v[w],d[v.charCodeAt(w)]=w;function b(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");return-1===r&&(r=e),[r,r===e?0:4-r%4]}function g(t,e,r){for(var n,a,o=[],i=e;i<r;i+=3)n=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),o.push(p[(a=n)>>18&63]+p[a>>12&63]+p[a>>6&63]+p[63&a]);return o.join("")}d["-".charCodeAt(0)]=62,d["_".charCodeAt(0)]=63;var E={byteLength:l,toByteArray:h,fromByteArray:_},P=function(t,e,r,n,a){var o,i,s=8*a-n-1,f=(1<<s)-1,u=f>>1,c=-7,l=r?a-1:0,h=r?-1:1,_=t[e+l];for(l+=h,o=_&(1<<-c)-1,_>>=-c,c+=s;c>0;o=256*o+t[e+l],l+=h,c-=8);for(i=o&(1<<-c)-1,o>>=-c,c+=n;c>0;i=256*i+t[e+l],l+=h,c-=8);if(0===o)o=1-u;else{if(o===f)return i?NaN:1/0*(_?-1:1);i+=Math.pow(2,n),o-=u}return(_?-1:1)*i*Math.pow(2,o-n)},A=function(t,e,r,n,a,o){var i,s,f,u=8*o-a-1,c=(1<<u)-1,l=c>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,_=n?0:o-1,p=n?1:-1,d=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,i=c):(i=Math.floor(Math.log(e)/Math.LN2),e*(f=Math.pow(2,-i))<1&&(i--,f*=2),(e+=i+l>=1?h/f:h*Math.pow(2,1-l))*f>=2&&(i++,f/=2),i+l>=c?(s=0,i=c):i+l>=1?(s=(e*f-1)*Math.pow(2,a),i+=l):(s=e*Math.pow(2,l-1)*Math.pow(2,a),i=0));a>=8;t[r+_]=255&s,_+=p,s/=256,a-=8);for(i=i<<a|s,u+=a;u>0;t[r+_]=255&i,_+=p,i/=256,u-=8);t[r+_-p]|=128*d},T=function(t,e){return t(e={exports:{}},e.exports),e.exports}((function(t,e){var r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},e.INSPECT_MAX_BYTES=50;function n(t){if(t>2147483647)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,a.prototype),e}function a(t,e,r){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return s(t)}return o(t,e,r)}function o(t,e,r){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|l(t,e),o=n(r),i=o.write(t,e);i!==r&&(o=o.slice(0,i));return o}(t,e);if(ArrayBuffer.isView(t))return f(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(j(t,ArrayBuffer)||t&&j(t.buffer,ArrayBuffer))return u(t,e,r);if("undefined"!=typeof SharedArrayBuffer&&(j(t,SharedArrayBuffer)||t&&j(t.buffer,SharedArrayBuffer)))return u(t,e,r);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var o=t.valueOf&&t.valueOf();if(null!=o&&o!==t)return a.from(o,e,r);var i=function(t){if(a.isBuffer(t)){var e=0|c(t.length),r=n(e);return 0===r.length||t.copy(r,0,0,e),r}if(void 0!==t.length)return"number"!=typeof t.length||H(t.length)?n(0):f(t);if("Buffer"===t.type&&Array.isArray(t.data))return f(t.data)}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return a.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function i(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function s(t){return i(t),n(t<0?0:0|c(t))}function f(t){for(var e=t.length<0?0:0|c(t.length),r=n(e),a=0;a<e;a+=1)r[a]=255&t[a];return r}function u(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return n=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(n,a.prototype),n}function c(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}function l(t,e){if(a.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||j(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var o=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return K(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return N(t).length;default:if(o)return n?-1:K(t).length;e=(""+e).toLowerCase(),o=!0}}function h(t,e,r){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return S(this,e,r);case"utf8":case"utf-8":return x(this,e,r);case"ascii":return B(this,e,r);case"latin1":case"binary":return M(this,e,r);case"base64":return T(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}function _(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function p(t,e,r,n,o){if(0===t.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),H(r=+r)&&(r=o?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(o)return-1;r=t.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof e&&(e=a.from(e,n)),a.isBuffer(e))return 0===e.length?-1:d(t,e,r,n,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):d(t,[e],r,n,o);throw new TypeError("val must be string, number or Buffer")}function d(t,e,r,n,a){var o,i=1,s=t.length,f=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;i=2,s/=2,f/=2,r/=2}function u(t,e){return 1===i?t[e]:t.readUInt16BE(e*i)}if(a){var c=-1;for(o=r;o<s;o++)if(u(t,o)===u(e,-1===c?0:o-c)){if(-1===c&&(c=o),o-c+1===f)return c*i}else-1!==c&&(o-=o-c),c=-1}else for(r+f>s&&(r=s-f),o=r;o>=0;o--){for(var l=!0,h=0;h<f;h++)if(u(t,o+h)!==u(e,h)){l=!1;break}if(l)return o}return-1}function y(t,e,r,n){r=Number(r)||0;var a=t.length-r;n?(n=Number(n))>a&&(n=a):n=a;var o=e.length;n>o/2&&(n=o/2);for(var i=0;i<n;++i){var s=parseInt(e.substr(2*i,2),16);if(H(s))return i;t[r+i]=s}return i}function v(t,e,r,n){return z(K(e,t.length-r),t,r,n)}function w(t,e,r,n){return z(function(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}(e),t,r,n)}function m(t,e,r,n){return w(t,e,r,n)}function b(t,e,r,n){return z(N(e),t,r,n)}function g(t,e,r,n){return z(function(t,e){for(var r,n,a,o=[],i=0;i<t.length&&!((e-=2)<0);++i)r=t.charCodeAt(i),n=r>>8,a=r%256,o.push(a),o.push(n);return o}(e,t.length-r),t,r,n)}function T(t,e,r){return 0===e&&r===t.length?E.fromByteArray(t):E.fromByteArray(t.slice(e,r))}function x(t,e,r){r=Math.min(t.length,r);for(var n=[],a=e;a<r;){var o,i,s,f,u=t[a],c=null,l=u>239?4:u>223?3:u>191?2:1;if(a+l<=r)switch(l){case 1:u<128&&(c=u);break;case 2:128==(192&(o=t[a+1]))&&(f=(31&u)<<6|63&o)>127&&(c=f);break;case 3:o=t[a+1],i=t[a+2],128==(192&o)&&128==(192&i)&&(f=(15&u)<<12|(63&o)<<6|63&i)>2047&&(f<55296||f>57343)&&(c=f);break;case 4:o=t[a+1],i=t[a+2],s=t[a+3],128==(192&o)&&128==(192&i)&&128==(192&s)&&(f=(15&u)<<18|(63&o)<<12|(63&i)<<6|63&s)>65535&&f<1114112&&(c=f)}null===c?(c=65533,l=1):c>65535&&(c-=65536,n.push(c>>>10&1023|55296),c=56320|1023&c),n.push(c),a+=l}return function(t){var e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);var r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=4096));return r}(n)}e.kMaxLength=2147483647,a.TYPED_ARRAY_SUPPORT=function(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(t,e,r){return o(t,e,r)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(t,e,r){return function(t,e,r){return i(t),t<=0?n(t):void 0!==e?"string"==typeof r?n(t).fill(e,r):n(t).fill(e):n(t)}(t,e,r)},a.allocUnsafe=function(t){return s(t)},a.allocUnsafeSlow=function(t){return s(t)},a.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==a.prototype},a.compare=function(t,e){if(j(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),j(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,n=e.length,o=0,i=Math.min(r,n);o<i;++o)if(t[o]!==e[o]){r=t[o],n=e[o];break}return r<n?-1:n<r?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var n=a.allocUnsafe(e),o=0;for(r=0;r<t.length;++r){var i=t[r];if(j(i,Uint8Array)&&(i=a.from(i)),!a.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},a.byteLength=l,a.prototype._isBuffer=!0,a.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_(this,e,e+1);return this},a.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_(this,e,e+3),_(this,e+1,e+2);return this},a.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_(this,e,e+7),_(this,e+1,e+6),_(this,e+2,e+5),_(this,e+3,e+4);return this},a.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?x(this,0,t):h.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(t,e,r,n,o){if(j(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),e<0||r>t.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&e>=r)return 0;if(n>=o)return-1;if(e>=r)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(n>>>=0),s=(r>>>=0)-(e>>>=0),f=Math.min(i,s),u=this.slice(n,o),c=t.slice(e,r),l=0;l<f;++l)if(u[l]!==c[l]){i=u[l],s=c[l];break}return i<s?-1:s<i?1:0},a.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},a.prototype.indexOf=function(t,e,r){return p(this,t,e,r,!0)},a.prototype.lastIndexOf=function(t,e,r){return p(this,t,e,r,!1)},a.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var a=this.length-e;if((void 0===r||r>a)&&(r=a),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return y(this,t,e,r);case"utf8":case"utf-8":return v(this,t,e,r);case"ascii":return w(this,t,e,r);case"latin1":case"binary":return m(this,t,e,r);case"base64":return b(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return g(this,t,e,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function B(t,e,r){var n="";r=Math.min(t.length,r);for(var a=e;a<r;++a)n+=String.fromCharCode(127&t[a]);return n}function M(t,e,r){var n="";r=Math.min(t.length,r);for(var a=e;a<r;++a)n+=String.fromCharCode(t[a]);return n}function S(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var a="",o=e;o<r;++o)a+=Y[t[o]];return a}function I(t,e,r){for(var n=t.slice(e,r),a="",o=0;o<n.length;o+=2)a+=String.fromCharCode(n[o]+256*n[o+1]);return a}function L(t,e,r){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function k(t,e,r,n,o,i){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}function C(t,e,r,n,a,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function R(t,e,r,n,a){return e=+e,r>>>=0,a||C(t,0,r,4),A(t,e,r,n,23,4),r+4}function U(t,e,r,n,a){return e=+e,r>>>=0,a||C(t,0,r,8),A(t,e,r,n,52,8),r+8}a.prototype.slice=function(t,e){var r=this.length;(t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t);var n=this.subarray(t,e);return Object.setPrototypeOf(n,a.prototype),n},a.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||L(t,e,this.length);for(var n=this[t],a=1,o=0;++o<e&&(a*=256);)n+=this[t+o]*a;return n},a.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||L(t,e,this.length);for(var n=this[t+--e],a=1;e>0&&(a*=256);)n+=this[t+--e]*a;return n},a.prototype.readUInt8=function(t,e){return t>>>=0,e||L(t,1,this.length),this[t]},a.prototype.readUInt16LE=function(t,e){return t>>>=0,e||L(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUInt16BE=function(t,e){return t>>>=0,e||L(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUInt32LE=function(t,e){return t>>>=0,e||L(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUInt32BE=function(t,e){return t>>>=0,e||L(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||L(t,e,this.length);for(var n=this[t],a=1,o=0;++o<e&&(a*=256);)n+=this[t+o]*a;return n>=(a*=128)&&(n-=Math.pow(2,8*e)),n},a.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||L(t,e,this.length);for(var n=e,a=1,o=this[t+--n];n>0&&(a*=256);)o+=this[t+--n]*a;return o>=(a*=128)&&(o-=Math.pow(2,8*e)),o},a.prototype.readInt8=function(t,e){return t>>>=0,e||L(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){t>>>=0,e||L(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt16BE=function(t,e){t>>>=0,e||L(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},a.prototype.readInt32LE=function(t,e){return t>>>=0,e||L(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return t>>>=0,e||L(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readFloatLE=function(t,e){return t>>>=0,e||L(t,4,this.length),P(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return t>>>=0,e||L(t,4,this.length),P(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return t>>>=0,e||L(t,8,this.length),P(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return t>>>=0,e||L(t,8,this.length),P(this,t,!1,52,8)},a.prototype.writeUIntLE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||k(this,t,e,r,Math.pow(2,8*r)-1,0);var a=1,o=0;for(this[e]=255&t;++o<r&&(a*=256);)this[e+o]=t/a&255;return e+r},a.prototype.writeUIntBE=function(t,e,r,n){(t=+t,e>>>=0,r>>>=0,n)||k(this,t,e,r,Math.pow(2,8*r)-1,0);var a=r-1,o=1;for(this[e+a]=255&t;--a>=0&&(o*=256);)this[e+a]=t/o&255;return e+r},a.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,1,255,0),this[e]=255&t,e+1},a.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},a.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var a=Math.pow(2,8*r-1);k(this,t,e,r,a-1,-a)}var o=0,i=1,s=0;for(this[e]=255&t;++o<r&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+r},a.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e>>>=0,!n){var a=Math.pow(2,8*r-1);k(this,t,e,r,a-1,-a)}var o=r-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+r},a.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},a.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||k(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeFloatLE=function(t,e,r){return R(this,t,e,!0,r)},a.prototype.writeFloatBE=function(t,e,r){return R(this,t,e,!1,r)},a.prototype.writeDoubleLE=function(t,e,r){return U(this,t,e,!0,r)},a.prototype.writeDoubleBE=function(t,e,r){return U(this,t,e,!1,r)},a.prototype.copy=function(t,e,r,n){if(!a.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-r&&(n=t.length-e+r);var o=n-r;if(this===t&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,n);else if(this===t&&r<e&&e<n)for(var i=o-1;i>=0;--i)t[i+e]=this[i+r];else Uint8Array.prototype.set.call(t,this.subarray(r,n),e);return o},a.prototype.fill=function(t,e,r,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(1===t.length){var o=t.charCodeAt(0);("utf8"===n&&o<128||"latin1"===n)&&(t=o)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var i;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"==typeof t)for(i=e;i<r;++i)this[i]=t;else{var s=a.isBuffer(t)?t:a.from(t,n),f=s.length;if(0===f)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<r-e;++i)this[i+e]=s[i%f]}return this};var O=/[^+/0-9A-Za-z-_]/g;function K(t,e){var r;e=e||1/0;for(var n=t.length,a=null,o=[],i=0;i<n;++i){if((r=t.charCodeAt(i))>55295&&r<57344){if(!a){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(i+1===n){(e-=3)>-1&&o.push(239,191,189);continue}a=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),a=r;continue}r=65536+(a-55296<<10|r-56320)}else a&&(e-=3)>-1&&o.push(239,191,189);if(a=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function N(t){return E.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,r,n){for(var a=0;a<n&&!(a+r>=e.length||a>=t.length);++a)e[a+r]=t[a];return a}function j(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function H(t){return t!=t}var Y=function(){for(var t=new Array(256),e=0;e<16;++e)for(var r=16*e,n=0;n<16;++n)t[r+n]="0123456789abcdef"[e]+"0123456789abcdef"[n];return t}()})),x=T.Buffer;T.SlowBuffer,T.INSPECT_MAX_BYTES,T.kMaxLength;const B=(M=x,(t,e)=>{if("string"==typeof t){if("string"==typeof e&&!M.isEncoding(e))throw new TypeError("Invalid default encoding.");return M.from(t,e)}if(t instanceof Uint8Array)return t;if("object"==typeof t&&"string"==typeof t.value&&M.isEncoding(t.encoding))return M.from(t.value,t.encoding);throw new TypeError("Invalid format of 'Data'.")});var M;const S=(t=>e=>{let r=t.from(e.buffer);return e.byteLength!==e.buffer.byteLength&&(r=r.slice(e.byteOffset,e.byteOffset+e.byteLength)),r})(x);class I{blind(t){const{Pythia:e}=u(),r=B(t,"utf8"),{blindedPassword:n,blindingSecret:a}=e.blind(r);return{blindedPassword:S(n),blindingSecret:S(a)}}deblind(t){const{Pythia:e}=u(),r=B(t.transformedPassword,"base64"),n=B(t.blindingSecret,"base64"),a=e.deblind(r,n);return S(a)}}t.VirgilBrainKeyCrypto=I,t.VirgilPythiaCrypto=class{constructor(t){this.virgilBrainKeyCrypto=t||new I}blind(t){return this.virgilBrainKeyCrypto.blind(t)}deblind(t){return this.virgilBrainKeyCrypto.deblind(t)}computeTransformationKeyPair(t){const{Pythia:e}=u(),r=B(t.transformationKeyId,"base64"),n=B(t.pythiaSecret,"base64"),a=B(t.pythiaScopeSecret,"base64"),{transformationPrivateKey:o,transformationPublicKey:i}=e.computeTransformationKeyPair(r,n,a);return{privateKey:S(o),publicKey:S(i)}}transform(t){const{Pythia:e}=u(),r=B(t.blindedPassword,"base64"),n=B(t.tweak,"base64"),a=B(t.transformationPrivateKey,"base64"),{transformedPassword:o,transformedTweak:i}=e.transform(r,n,a);return{transformedPassword:S(o),transformedTweak:S(i)}}prove(t){const{Pythia:e}=u(),r=B(t.transformedPassword,"base64"),n=B(t.blindedPassword,"base64"),a=B(t.transformedTweak,"base64"),{proofValueC:o,proofValueU:i}=e.prove(r,n,a,t.transformationKeyPair.privateKey,t.transformationKeyPair.publicKey);return{proofValueC:S(o),proofValueU:S(i)}}verify(t){const{Pythia:e}=u(),r=B(t.transformedPassword,"base64"),n=B(t.blindedPassword,"base64"),a=B(t.tweak,"base64"),o=B(t.transformationPublicKey,"base64"),i=B(t.proofValueC,"base64"),s=B(t.proofValueU,"base64");return e.verify(r,n,a,o,i,s)}getPasswordUpdateToken(t){const{Pythia:e}=u(),r=B(t.oldTransformationPrivateKey,"base64"),n=B(t.newTransformationPrivateKey,"base64"),a=e.getPasswordUpdateToken(r,n);return S(a)}updateDeblindedWithToken(t){const{Pythia:e}=u(),r=B(t.deblindedPassword,"base64"),n=B(t.updateToken,"base64"),a=e.updateDeblindedWithToken(r,n);return S(a)}},t.getPythiaModules=u,t.hasPythiaModules=()=>f.hasModule("pythia"),t.initPythia=c,t.moduleInitializer=f,t.setPythiaModules=t=>{f.setModule("pythia",t)},Object.defineProperty(t,"__esModule",{value:!0})}));
